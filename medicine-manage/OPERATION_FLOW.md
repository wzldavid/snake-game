# 🗺️ 数据库建立操作流程图

## 📋 操作流程

```
┌─────────────────────────────────────────────────────────────┐
│           数据库建立操作流程                               │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
        ┌───────────────────────────────┐
        │  第1步: 打开控制台           │
        │  https://console.cloud.      │
        │  tencent.com/tcb?envId=      │
        │  wzldavid-4gwhey9fe011d906   │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  第2步: 进入数据库页面        │
        │  云开发 → 数据库 → 文档数据库  │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  第3步: 创建users集合        │
        │  - 新建集合                  │
        │  - 名称: users              │
        │  - 导入2条用户数据            │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  第4步: 创建blood_glucose   │
        │  - 新建集合                  │
        │  - 名称: blood_glucose      │
        │  - 导入157条血糖数据          │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  第5步: 创建blood_pressure  │
        │  - 新建集合                  │
        │  - 名称: blood_pressure     │
        │  - 导入87条血压数据           │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  第6步: 配置安全规则        │
        │  - users规则                │
        │  - blood_glucose规则        │
        │  - blood_pressure规则        │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  ✅ 完成!                    │
        │  数据库已建立                 │
        └───────────────┬───────────────┘
                        │
                        ▼
        ┌───────────────────────────────┐
        │  下一步: 部署云函数          │
        │  参考: START_HERE.md         │
        └───────────────────────────────┘
```

## 🎯 操作检查清单

### 阶段1: 准备工作
```
☐ 已打开云开发控制台
☐ 已进入数据库页面
☐ 已准备测试数据文件
```

### 阶段2: 创建集合
```
☐ users 集合已创建(2条记录)
☐ blood_glucose 集合已创建(157条记录)
☐ blood_pressure 集合已创建(87条记录)
```

### 阶段3: 配置规则
```
☐ users 安全规则已配置
☐ blood_glucose 安全规则已配置
☐ blood_pressure 安全规则已配置
```

### 阶段4: 验证完成
```
☐ 所有数据已验证
☐ 所有规则已保存
☐ 可以进行下一步
```

## 📊 数据导入明细

### users 集合
```
集合名称: users
数据来源: cloud-database-test-data.json (第2-33行)
记录数量: 2条
导入方式: 复制JSON → 粘贴到集合

用户1: 张大爷
  - openid: test_openid_zhang_001
  - 年龄: 70岁
  - 糖尿病: 是
  - 高血压: 是

用户2: 刘大妈
  - openid: test_openid_liu_001
  - 年龄: 67岁
  - 糖尿病: 是
  - 高血压: 否
```

### blood_glucose 集合
```
集合名称: blood_glucose
数据来源: cloud-database-test-data.json (第34-660行)
记录数量: 157条
导入方式: 复制JSON → 粘贴到集合(可分批)

测量类型分布:
  - 空腹: ~31条
  - 早餐后: ~32条
  - 午餐后: ~31条
  - 晚餐后: ~31条
  - 睡前: ~32条

异常数据: ~11条 (7%)
```

### blood_pressure 集合
```
集合名称: blood_pressure
数据来源: cloud-database-test-data.json (第661-3209行)
记录数量: 87条
导入方式: 复制JSON → 粘贴到集合(可分批)

用户分布:
  - 张大爷: 42条
  - 刘大妈: 45条

异常数据: ~11条 (13%)
```

## 🔗 快速访问链接

### 云开发控制台
```
主控台: https://console.cloud.tencent.com/tcb
当前环境: https://console.cloud.tencent.com/tcb?envId=wzldavid-4gwhey9fe011d906
```

### 数据库页面
```
数据库列表: https://tcb.cloud.tencent.com/dev?envId=wzldavid-4gwhey9fe011d906#/db/doc
安全规则: https://tcb.cloud.tencent.com/dev?envId=wzldavid-4gwhey9fe011d906#/db/doc/security
```

### 云函数页面
```
云函数列表: https://tcb.cloud.tencent.com/dev?envId=wzldavid-4gwhey9fe011d906#/scf
```

## 💡 操作提示

### 导入数据技巧

1. **使用编辑器打开文件**
   - 推荐使用VSCode
   - 查找"users"、"blood_glucose"、"blood_pressure"
   - 选中数组内容(包括方括号)

2. **分批导入策略**
   - 如果一次性导入失败,分批进行
   - 每批20-50条
   - 逐步完成导入

3. **验证导入结果**
   - 每次导入后检查记录数
   - 确认数据完整性
   - 发现问题及时重试

### 配置安全规则

1. **测试环境**(推荐)
   ```json
   {
     "read": true,
     "write": true
   }
   ```

2. **生产环境**(正式上线)
   ```json
   {
     "read": "auth != null && auth.openid == doc._openid",
     "write": "auth != null && auth.openid == doc._openid"
   }
   ```

### 遇到问题

1. **导入失败**
   - 检查JSON格式
   - 尝试分批导入
   - 刷新页面重试

2. **看不到数据**
   - 刷新浏览器
   - 重新点击集合
   - 检查错误提示

3. **规则配置失败**
   - 检查JSON语法
   - 确认权限设置
   - 点击保存并刷新

---

**按照流程图和检查清单操作,5分钟内即可完成数据库建立!** 🚀
