# 任务分解文档 - 老人健康记录小程序

## 文档信息
- **项目名称**: 老人健康记录小程序
- **文档版本**: v1.0
- **创建日期**: 2026-01-31
- **文档类型**: 任务分解文档

## 实施计划

### 阶段一: 基础设施搭建(2天)

- [ ] 1.1 云开发环境配置
  - 初始化云开发环境(wzldavid-4gwhey9fe011d906)
  - 创建数据库集合并配置索引
  - 创建云存储桶
  - 配置数据库安全规则
  - _需求: 非功能需求-安全需求_

- [ ] 1.2 数据库安全规则配置
  - 配置users集合读写规则
  - 配置blood_glucose集合读写规则
  - 配置blood_pressure集合读写规则
  - 配置admins集合读写规则
  - 配置abnormal_alerts集合读写规则
  - _需求: 非功能需求-安全需求_

- [ ] 1.3 后台管理系统项目搭建
  - 初始化Vue 3 + Element Plus项目
  - 配置路由和状态管理(Pinia)
  - 配置网络请求封装
  - 配置UI主题(温馨暖色调)
  - _需求: 2.2.1 管理员登录_

### 阶段二: 小程序端核心功能开发(7天)

#### 2.1 用户认证与个人中心(1天)

- [ ] 2.1.1 用户登录功能
  - 实现微信授权登录
  - 创建用户登录云函数
  - 处理新用户注册逻辑
  - 保存用户信息到数据库
  - _需求: 2.1.1 用户注册与登录_

- [ ] 2.1.2 个人中心页面
  - 实现个人中心UI
  - 显示用户基本信息
  - 支持编辑个人信息(姓名、性别、出生日期)
  - 支持设置病史(糖尿病、高血压)
  - 保存用户信息到数据库
  - _需求: 2.1.10 个人档案管理_

#### 2.2 血糖记录功能(2天)

- [ ] 2.2.1 血糖手动记录页面
  - 实现血糖记录页面UI(温馨暖色调设计)
  - 实现血糖值输入(数字键盘)
  - 实现测量时间选择(空腹、餐后等)
  - 实现数据验证(范围2.0-30.0 mmol/L)
  - 实现保存记录功能
  - _需求: 2.1.2 血糖手动记录_

- [ ] 2.2.2 血糖云函数开发
  - 创建addBloodGlucose云函数
  - 实现血糖记录添加逻辑
  - 实现异常数据判断逻辑
  - 调用checkAbnormal云函数创建预警
  - _需求: 2.1.2 血糖手动记录_

- [ ] 2.2.3 血糖照片识别功能
  - 实现拍照功能调用
  - 实现相册选择功能
  - 创建recognizeFromPhoto云函数
  - 集成AI OCR识别能力
  - 实现识别结果自动填充
  - _需求: 2.1.4 血糖照片自动扫描_

- [ ] 2.2.4 血压照片识别功能
  - 实现拍照功能调用
  - 实现相册选择功能
  - 扩展recognizeFromPhoto云函数支持血压识别
  - 集成AI OCR识别能力
  - 实现识别结果自动填充
  - _需求: 2.1.5 血压照片自动扫描_

#### 2.3 血压记录功能(1.5天)

- [ ] 2.3.1 血压手动记录页面
  - 实现血压记录页面UI(温馨暖色调设计)
  - 实现收缩压和舒张压输入(数字键盘)
  - 实现心率输入(可选)
  - 实现数据验证(收缩压60-250,舒张压40-150)
  - 实现保存记录功能
  - _需求: 2.1.3 血压手动记录_

- [ ] 2.3.2 血压云函数开发
  - 创建addBloodPressure云函数
  - 实现血压记录添加逻辑
  - 实现异常数据判断逻辑
  - 调用checkAbnormal云函数创建预警
  - _需求: 2.1.3 血压手动记录_

#### 2.4 历史记录查看(1天)

- [ ] 2.4.1 历史记录列表页面
  - 实现历史记录列表UI(卡片式布局)
  - 实现血糖和血压记录合并展示
  - 实现日期筛选(今天、本周、本月)
  - 实现分页加载(每页20条)
  - 实现记录详情查看
  - _需求: 2.1.6 历史记录查看_

- [ ] 2.4.2 记录管理云函数
  - 创建getHealthData云函数
  - 实现记录查询逻辑
  - 实现分页查询逻辑
  - 实现记录删除逻辑
  - _需求: 2.1.6 历史记录查看_

#### 2.5 趋势分析功能(1.5天)

- [ ] 2.5.1 血糖趋势页面
  - 实现血糖趋势页面UI
  - 集成ECharts图表库
  - 实现最近7天血糖折线图
  - 实现不同测量时段切换
  - 实现异常点标注
  - 实现统计数据展示(平均值、最大值、最小值)
  - _需求: 2.1.7 血糖趋势分析_

- [ ] 2.5.2 血压趋势页面
  - 实现血压趋势页面UI
  - 集成ECharts图表库
  - 实现最近7天血压折线图
  - 实现收缩压和舒张压双曲线展示
  - 实现异常点标注
  - 实现统计数据展示(平均值、最大值、最小值)
  - _需求: 2.1.8 血压趋势分析_

- [ ] 2.5.3 趋势数据云函数
  - 创建getTrendData云函数
  - 实现趋势数据查询逻辑
  - 实现数据统计逻辑
  - 实现异常点识别逻辑
  - _需求: 2.1.7 血糖趋势分析, 2.1.8 血压趋势分析_

#### 2.6 异常预警功能(1天)

- [ ] 2.6.1 异常数据判断逻辑
  - 创建checkAbnormal云函数
  - 实现血糖异常判断(高血糖、低血糖)
  - 实现血压异常判断(高血压、低血压)
  - 根据病史调整判断阈值
  - _需求: 2.1.9 异常数据预警_

- [ ] 2.6.2 异常预警展示
  - 实现首页异常预警横幅
  - 实现异常数据列表展示
  - 实现异常数据详情查看
  - 实现异常数据高亮显示
  - _需求: 2.1.9 异常数据预警_

- [ ] 2.6.3 异常预警云函数
  - 创建异常预警记录到数据库
  - 实现预警状态管理
  - 实现预警通知功能
  - _需求: 2.1.9 异常数据预警_

### 阶段三: 后台管理系统开发(5天)

#### 3.1 认证与权限(1天)

- [ ] 3.1.1 管理员登录页面
  - 实现登录页面UI
  - 实现用户名密码登录
  - 实现登录表单验证
  - 实现JWT Token管理
  - 实现登录失败次数限制
  - _需求: 2.2.1 管理员登录_

- [ ] 3.1.2 管理员云函数
  - 创建adminLogin云函数
  - 实现管理员身份验证
  - 实现JWT Token生成
  - 实现登录失败次数限制
  - 实现密码加密验证
  - _需求: 2.2.1 管理员登录_

- [ ] 3.1.3 权限管理
  - 实现路由守卫
  - 实现Token自动刷新
  - 实现权限验证中间件
  - 实现登出功能
  - _需求: 非功能需求-安全需求_

#### 3.2 用户管理功能(1天)

- [ ] 3.2.1 用户列表页面
  - 实现用户列表页面UI
  - 实现用户信息表格展示
  - 实现搜索功能
  - 实现分页功能
  - 实现空状态提示
  - _需求: 2.2.2 老人列表查看_

- [ ] 3.2.2 用户详情页面
  - 实现用户详情页面UI
  - 显示用户基本信息
  - 显示用户病史信息
  - 显示最后记录时间
  - _需求: 2.2.2 老人列表查看_

- [ ] 3.2.3 用户管理云函数
  - 创建getUserList云函数
  - 实现用户列表查询
  - 实现用户搜索逻辑
  - 实现分页查询逻辑
  - _需求: 2.2.2 老人列表查看_

#### 3.3 健康数据查看功能(1.5天)

- [ ] 3.3.1 健康数据页面
  - 实现健康数据页面UI
  - 实现血糖趋势图表(最近7天)
  - 实现血压趋势图表(最近7天)
  - 实现日期选择器
  - 实现健康记录表格展示
  - 实现异常数据高亮
  - _需求: 2.2.3 老人健康数据查看(按日)_

- [ ] 3.3.2 健康趋势页面
  - 实现健康趋势页面UI
  - 实现血糖趋势图表(可选时间段)
  - 实现血压趋势图表(可选时间段)
  - 实现异常点标注
  - 实现数据点交互显示详情
  - _需求: 2.2.4 老人健康趋势查看(按日)_

- [ ] 3.3.3 健康数据云函数
  - 创建getUserHealthData云函数
  - 实现按日查询健康数据
  - 实现趋势数据查询逻辑
  - 实现数据统计逻辑
  - _需求: 2.2.3 老人健康数据查看(按日)_

#### 3.4 异常预警管理(1天)

- [ ] 3.4.1 异常预警列表页面
  - 实现异常预警列表页面UI
  - 实现异常数据表格展示
  - 实现异常类型筛选
  - 实现按时间倒序排列
  - 实现异常预警数量显示
  - _需求: 2.2.5 异常数据列表_

- [ ] 3.4.2 异常预警详情
  - 实现异常预警详情查看
  - 实现跳转到老人健康数据页面
  - 实现异常预警处理状态更新
  - _需求: 2.2.5 异常数据列表_

- [ ] 3.4.3 异常预警云函数
  - 创建getAbnormalAlerts云函数
  - 实现异常预警查询
  - 实现异常类型筛选
  - 实现预警状态更新
  - _需求: 2.2.5 异常数据列表_

#### 3.5 数据导出功能(0.5天)

- [ ] 3.5.1 数据导出页面
  - 实现数据导出页面UI
  - 实现时间范围选择
  - 实现导出内容选择(血糖/血压/全部)
  - 实现导出按钮
  - _需求: 2.2.6 数据导出_

- [ ] 3.5.2 数据导出云函数
  - 创建exportHealthData云函数
  - 实现Excel文件生成
  - 实现文件上传到云存储
  - 实现文件URL返回
  - _需求: 2.2.6 数据导出_

- [ ] 3.5.3 前端文件下载
  - 实现Excel文件下载
  - 实现下载进度提示
  - 实现下载成功提示
  - _需求: 2.2.6 数据导出_

### 阶段四: 联调与测试(3天)

#### 4.1 功能测试(1天)

- [ ] 4.1.1 小程序功能测试
  - 测试用户登录/注册
  - 测试血糖记录功能
  - 测试血压记录功能
  - 测试照片识别功能
  - 测试历史记录查看
  - 测试趋势分析功能
  - 测试异常预警功能
  - 测试个人中心功能
  - _需求: 所有小程序功能需求_

- [ ] 4.1.2 后台管理系统测试
  - 测试管理员登录
  - 测试用户列表查看
  - 测试健康数据查看
  - 测试健康趋势查看
  - 测试异常预警管理
  - 测试数据导出功能
  - _需求: 所有后台管理功能需求_

#### 4.2 性能测试(0.5天)

- [ ] 4.2.1 性能基准测试
  - 测试小程序首次加载时间(≤3秒)
  - 测试数据提交响应时间(≤2秒)
  - 测试照片识别响应时间(≤5秒)
  - 测试趋势图表加载时间(≤2秒)
  - _需求: 非功能需求-性能需求_

- [ ] 4.2.2 并发测试
  - 测试100名用户同时使用
  - 测试云函数并发调用
  - 测试数据库查询性能
  - 测试系统稳定性
  - _需求: 非功能需求-性能需求_

#### 4.3 用户体验测试(1天)

- [ ] 4.3.1 老年人可用性测试
  - 邀请老年人用户测试核心功能
  - 收集操作难度反馈
  - 测试字体大小是否合适
  - 测试按钮大小是否合适
  - 测试操作流程是否简洁
  - _需求: 非功能需求-可用性需求_

- [ ] 4.3.2 界面易用性测试
  - 测试界面直观性
  - 测试色彩对比度
  - 测试信息层级清晰度
  - 测试操作反馈及时性
  - _需求: 非功能需求-可用性需求, UI/UX设计要求_

- [ ] 4.3.3 照片识别准确率测试
  - 测试各种血糖计识别准确率
  - 测试各种血压计识别准确率
  - 测试不同光照条件下识别效果
  - 目标识别准确率≥95%
  - _需求: 7.2 性能验收_

#### 4.4 Bug修复(0.5天)

- [ ] 4.4.1 Bug修复
  - 修复功能测试发现的问题
  - 修复性能测试发现的问题
  - 修复用户体验测试发现的问题
  - 验证Bug修复效果
  - _需求: 7.1 功能验收, 7.2 性能验收, 7.3 用户体验验收_

### 阶段五: 发布准备(2天)

#### 5.1 代码优化(0.5天)

- [ ] 5.1.1 代码审查与优化
  - 审查代码规范性
  - 优化代码结构
  - 添加代码注释
  - 优化性能瓶颈
  - _需求: 无特定需求_

- [ ] 5.1.2 资源优化
  - 压缩图片资源
  - 优化静态资源加载
  - 配置CDN加速
  - 清理无用代码和资源
  - _需求: 非功能需求-性能需求_

#### 5.2 文档编写(0.5天)

- [ ] 5.2.1 用户使用手册
  - 编写小程序使用手册
  - 编写后台管理系统使用手册
  - 添加操作截图和说明
  - _需求: 无特定需求_

- [ ] 5.2.2 部署文档
  - 编写云函数部署文档
  - 编写后台系统部署文档
  - 编写数据库配置文档
  - _需求: 无特定需求_

#### 5.3 小程序提交审核(0.5天)

- [ ] 5.3.1 小程序准备
  - 检查小程序代码合规性
  - 准备小程序审核材料
  - 配置小程序基本信息
  - 测试小程序所有功能
  - _需求: 无特定需求_

- [ ] 5.3.2 提交审核
  - 上传小程序代码
  - 提交微信审核
  - 准备审核说明
  - _需求: 无特定需求_

#### 5.4 后台系统部署(0.5天)

- [ ] 5.4.1 后台系统构建
  - 构建生产环境代码
  - 配置生产环境变量
  - 测试生产环境部署
  - _需求: 无特定需求_

- [ ] 5.4.2 上线部署
  - 部署到云开发静态托管
  - 配置自定义域名
  - 配置HTTPS证书
  - 测试线上功能
  - _需求: 无特定需求_

### 阶段六: 监控与维护(持续)

#### 6.1 监控配置(持续)

- [ ] 6.1.1 监控告警配置
  - 配置云函数调用监控
  - 配置错误率告警
  - 配置性能监控
  - 配置存储使用量告警
  - _需求: 9.1 监控指标, 9.2 告警机制_

- [ ] 6.1.2 日志收集
  - 配置云函数日志收集
  - 配置操作日志记录
  - 配置错误日志收集
  - _需求: 6.3 日志与监控_

#### 6.2 数据备份(持续)

- [ ] 6.2.1 备份策略实施
  - 配置数据库每日自动备份
  - 验证备份数据完整性
  - 配置备份保留策略
  - _需求: 9.3 备份策略_

#### 6.3 运营支持(持续)

- [ ] 6.3.1 用户反馈收集
  - 收集用户使用反馈
  - 整理常见问题
  - 优化产品功能
  - _需求: 无特定需求_

- [ ] 6.3.2 数据分析
  - 分析用户使用数据
  - 分析健康数据趋势
  - 生成数据分析报告
  - _需求: 无特定需求_

## 里程碑

| 里程碑 | 完成时间 | 交付物 |
|--------|----------|--------|
| M1: 基础设施搭建完成 | Day 2 | 云开发环境、数据库、后台系统基础框架 |
| M2: 小程序核心功能完成 | Day 9 | 小程序可完整记录血糖、血压、查看趋势 |
| M3: 后台管理系统完成 | Day 14 | 后台可查看用户健康数据、异常预警 |
| M4: 联调测试完成 | Day 17 | 所有功能测试通过,性能达标 |
| M5: 发布完成 | Day 19 | 小程序审核通过,后台系统上线 |

## 风险与应对

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 照片识别准确率不达标 | 高 | 中 | 预留时间优化算法,考虑使用第三方OCR服务 |
| 老年人操作困难 | 高 | 中 | 多轮用户体验测试,及时调整交互设计 |
| 小程序审核不通过 | 中 | 低 | 提前了解审核规则,准备充分的材料 |
| 云开发资源不足 | 中 | 低 | 监控资源使用,及时升级套餐 |
| 数据安全问题 | 高 | 低 | 严格权限控制,数据加密存储 |

## 资源需求

### 人力资源
- 前端开发工程师: 1人
- 后端开发工程师: 1人
- 测试工程师: 0.5人
- UI设计师: 0.5人

### 技术资源
- 微信小程序开发工具
- 腾讯云开发环境
- Vue 3 + Element Plus
- ECharts图表库
- AI OCR服务

### 时间资源
- 总计19个工作日
- 约3.8周(按每周5天计算)

---

**文档结束**
